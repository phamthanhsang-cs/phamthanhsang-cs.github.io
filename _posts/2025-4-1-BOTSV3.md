---
title: Boss of the SOC version 3 Write-ups
date: 2025-6-7 00:00:00 + 0700
categories: [siem, blue-teaming, soc, ctf-challenge]
tags: [splunk, threat-hunting, log-analysis, write-ups]    
author: <author_id>   
description: Frothly Beer is moving their infrastructure to the cloud using a multi-cloud strategy. Let's help them detect suspicious activities while their business evolves significantly. 
# toc: false - uncomment to turn off Table of Contents which is use for display content in right-panel 
#comments: false # uncomment to turn on comment 
image: /assets/images/preview/botsv3.png
---
# Introduction

Hi Splunkers! Welcome back to my **Boss of the SOC (BOTS)** series on my blog.

If you haven’t read my previous [BOTSv1 Write-ups](https://phamthanhsang-cs.site/posts/BOTSV1/) and [BOTSv2 Write-ups](https://phamthanhsang-cs.site/posts/BOTSV2/) yet, I highly recommend checking them out first. They’ll give you a solid understanding of [Boss of the SOC – the Blue Team CTF Challenge created by Splunk](https://www.splunk.com/en_us/blog/security/what-you-need-to-know-about-boss-of-the-soc.html). I’d really appreciate it!


### About Boss of the SOC Version 3

**Boss of the SOC Version 3** is the latest publicly available BOTS CTF Challenge created by Splunk. In this version, we step into the shoes of **Alice Bluebird** - a quirky cybersecurity analyst to help organizations uncover the root causes of their digital chaos.

In the previous version (BOTSv2), we helped **Frothly**, a fictional craft beer company, detect hidden threats in their environment. From insiders using Tor to hide their activities, to external APTs attempting to exfiltrate intellectual property - it was intense.

Now, in BOTSv3, Frothly has grown rapidly and their traditional infrastructure can no longer keep up. As part of their technological evolution, they’ve migrated their environment to the cloud — utilizing both **AWS** and **Azure** for different business needs.

But as we know, for hackers, there’s nowhere to hide. As security analysts, it’s our job to help Frothly identify suspicious activity and trace the **root cause of digital chaos** in their expanded cloud infrastructure.

> **Fun Fact about my Boss of the SOC series:**  
> BOTSv3 was actually the **first version I completed**, even before versions 1 and 2!  
> It all started back in **April 2024**, with a Splunk instance running on a Linux VM inside my VirtualBox.  
> Revisiting this version now not only helps **refresh the knowledge** I’ve gained, but also sharpens the **analytical skills** I’ve developed since then.
{: .prompt-info }

# Environment Setup

- **Pre-requisites:**  
  Participating in **Boss of the SOC (BOTS)** is easier than ever thanks to its availability on various platforms:
  - [TryHackMe](https://tryhackme.com/)
  - [CyberDefenders](https://cyberdefenders.org/)

  Unfortunately, **Boss of the SOC v3** doesn’t appear on Splunk’s official website, but they have made the dataset [public on GitHub](https://github.com/splunk/botsv3) for anyone who wants to download it and give it a try.

  > *However, all walkthroughs in this guide are based on a **self-hosted setup**, including an approximation of what the CTF scoreboard looks like.*
  > *If you'd like to follow along or set up your own environment, check out this [detailed setup guide](https://phamthanhsang-cs.github.io/posts/BOTS-setup/) where we walk through everything step-by-step. Thanks!*

- **Dataset Information:**  
  Unlike BOTSv1 and BOTSv2, the third version only includes a **pre-indexed dataset** (~320MB), with a total of around **2 million events**.

  ![pic1](assets/images/botsv3/pic1.png)

# Walkthrough 
### Let's Splunking !
Same as both previous versions. before deep diving into answer BOTS questions, i would like to prepare some SPL searches to help us easier to hunting threats: 
- First is `|metadata index="botsv1" type=sourcetypes | stats values(sourcetype)`, the following SPL command helps me quickly identify the sourcetypes present in the dataset. This gives me a clear idea of the types of data we should focus on during investigation:
- The second one is `|metasearch index="botsv1" sourcetype=<specific_sourcetype> <keyword>`.
- The third one is `|fieldsummary` with [marcro](https://docs.splunk.com/Splexicon:Searchmacro) setup. My search will look like this:

```sql
| fieldsummary 
| fields field values value 
| rex field=values max_match=0 "\"value\":\"(?<value>[^\"]+)\""
| fields field value
```
*And i'd set this search with marcro named `spog` (single pane of glass), you will see why those searches helped me so much in this walkthrough.*

![pic2](assets/images/botsv3/pic2.png)
_WELCOME BACK TO MY BOSS OF THE SOC SERIES_

### Series 200

#### Question 1 (200): List out the IAM users that accessed an AWS service (successfully or unsuccessfully) in Frothly's AWS environment? Answer guidance: Comma separated without spaces, in alphabetical order. (Example: ajackson,mjones,tmiller)

