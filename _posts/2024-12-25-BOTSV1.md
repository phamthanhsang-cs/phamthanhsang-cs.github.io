---
title: Boss of the SOC version 1 Walkthrough
date: 2024-12-25 16:20:00 + 0700
categories: [SIEM, Write-ups]
tags: [splunk, walkthrough]    
author: <author_id>   
description: Help Batman and his company - Wayne Corp as a Alice Bluebird's cybersecurity analyst !
# toc: false - uncomment to turn off Table of Contents which is use for display content in right-panel 
comments: false # uncomment to turn on comment 
image: /assets/images/preview/botsv1.png
---
# Introduction 
### What is Boss of the SOC (BOTS) ?
- **Overview:** BOTS (Boss of the SOC) is a blue-team Capture the Flag (CTF) challenge developed by Splunk. It immerses participants in realistic security incidents within enterprise environments, leveraging Splunk as the primary platform alongside other tools. Participants analyze data, investigate threats, and answer questions based on "real-world" scenarios.  
- **Purpose:** You could see easily while most CTF challenges cater to red teams, BOTS focuses on empowering blue teams by providing a dedicated platform for defenders to hone our skills. It’s a unique opportunity for us to sharpen our detection, analysis, and incident response capabilities in a competitive yet collaborative environment.
- **Tools and techniques:** 
  - **Primary Tool**: Splunk (ofc!) as the core SIEM.
  - **Supporting Skills:** Utilizing OSINTs, networking fundamentals, cloud computing services including AWS and Azure (particularly emphasized in BOTSv3), web application security, and operating system knowledge.
  - **Mindset:** Above all, success requires a threat-hunting mindset, thinking outside the "Splunk" box to creatively identify and analyze threats.
  
### Why i write this walkthrough ?
As I write this in December 2024, I reflect on my experience participating in Boss of the SOC (BOTS) earlier this year, starting in late April 2024. This walkthrough serves two key purposes:
- **Sharing Knowledge:** BOTS provided me with invaluable insights into real-world incident response and threat hunting. By documenting my experience, I hope to share practical knowledge and strategies that can help others excel in this unique challenge.
- **Self-Reflection:** Revisiting the challenges and solutions from BOTS allows me to consolidate what I’ve learned and identify areas for improvement. This walkthrough is as much a guide for others as it is a personal milestone in my cybersecurity journey.


### About Boss of the SOC version 1
- **BOTSv1** is the first-ever Boss of the SOC (BOTS) event debuted at Splunk **.conf2016**. This initial challenge introduced participants to an engaging and immersive storyline centered around Wayne Corporation—one of the largest and most influential companies in the world, famously associated with Batman (In imagination, ofc xD).

- The scenario begins with a startling incident: the **defacement** of the Wayne Corporation website. As participants, we step into the role of Alice Bluebird' persona, **a security analyst** tasked with conducting a **root cause analysis**. Our mission is to **investigate** the incident, uncover the series of events that led to the attack, and answer a series of questions designed to guide us through the forensic investigation.

# Enviroment setup
- **Pre-requisites:** Participating in Boss of the SOC (BOTS) is easier than ever, thanks to its availability on various platforms:
  - [Splunk Officialy](https://bots.splunk.com/login?redirect=/)
  - [TryHackMe](https://tryhackme.com/)
  - [CyberDefenders](https://cyberdefenders.org/)
  
*However, all the walkthroughs in this guide are based on **self-hosted setup**, including more or less what's CTF scoreboard look like. If you'd like to follow along or set up your own environment, check out this [detailed post](http://localhost:4000/posts/BOTS-setup/) where we’ll walk through everything step-by-step together, thank you.*

- **Dataset Information:** For this walkthrough, I’m using the complete dataset from BOTSv1, which includes approximately 33 million event records. This dataset is notably challenging due to the mix of **legitimate activity**, **noisy data**, and **attack events**. While it adds complexity, it also provides an excellent opportunity to hone our search and analysis skills, making the experience both rewarding and comprehensive.

# Walkthrough 
### Let's Splunking !
Before deep diving into answer BOTS questions, i would like to prepare some SPL search to make my life easier since me and your are going to "Black box hunting", right ?
- First is `|metadata index="botsv1" type=sourcetypes | stats values(sourcetype)`, the following SPL command helps me quickly identify the sourcetypes present in the dataset. This gives me a clear idea of the types of data we should focus on during investigation:
- The second one is `|metasearch index="botsv1" sourcetype=<specific_sourcetype> <keyword>`, this command helps me pinpoint specific data sources based on your investigation's context and keywords. For example, if the challenge involves a web application security question, and have some sort of keywords like "injection" or "spoofing." While this could involve multiple sourcetypes such as HTTP logs, firewall logs, or IDS/IPS logs, this command helps narrow the scope. It provides a starting point for which sourcetypes are most likely to contain the relevant information.
- The third one is `|fieldsummary` with marcro. The full of my search is:
```sql
| fieldsummary 
| fields field values value 
| rex field=values max_match=0 "\"value\":\"(?<value>[^\"]+)\""
| fields field value
```
#### Question 1 (101): What is the likely IP address of someone from the Po1s0n1vy group scanning imreallynotbatman.com for web application vulnerabilities?


