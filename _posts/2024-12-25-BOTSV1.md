---
title: Boss of the SOC version 1 Walkthrough
date: 2024-12-25 16:20:00 + 0700
categories: [SIEM, Write-ups]
tags: [splunk, walkthrough]    
author: <author_id>   
description: Help Batman and his company - Wayne Corp as a Alice Bluebird's cybersecurity analyst !
# toc: false - uncomment to turn off Table of Contents which is use for display content in right-panel 
comments: false # uncomment to turn on comment 
image: /assets/images/preview/botsv1.png
---
# Introduction 
### What is Boss of the SOC (BOTS) ?
- **Overview:** BOTS (Boss of the SOC) is a **[blue-team](https://en.wikipedia.org/wiki/Blue_team_(computer_security))** Capture the Flag (CTF) challenge created by *Splunk*. It gives participants the chance to dive into realistic **security incidents** within enterprise environments, using Splunk as the main platform along with other tools. The challenge involves **analyzing** data, **investigating** threats, and answering questions based on **real-world** scenarios.
- **Purpose:** You could see easily while most CTF challenges are designed for **[red teams](https://en.wikipedia.org/wiki/Red_team)**, BOTS stands out by focusing on blue teams. It provides a dedicated platform for defenders like us to sharpen our skills. It’s a great way to improve our ability to **detect**, **analyze**, and **identify** incidents in a competitive yet collaborative setting.
- **Tools and techniques:** 
  - **Primary Tool**: Splunk (ofc!) as the core SIEM.
  - **Supporting Skills:** Skills like utilize OSINT, networking fundamentals, cloud computing with AWS and Azure (especially in BOTSv3), web application security, and operating system knowledges all come into play.
  - **Mindset:** Most importantly, success depends on having a **threat-hunting** mindset, thinking beyond the "Splunk box" to creatively identify and analyze threats.
  
### Why i write this walkthrough ?
As I write this in December 2024, I reflect on my experience participating in Boss of the SOC (BOTS) earlier this year, starting in late April 2024. This walkthrough serves two key purposes:
- **Sharing Knowledge:** BOTS gave me invaluable insights into real-world incident response and threat hunting. By documenting my experience, I want to share the strategies and lessons I’ve learned to help others succeed in this unique challenge.
- **Self-Reflection:** Revisiting the challenges and solutions from BOTS allows me to consolidate what I’ve learned and identify areas for improvement. This walkthrough is as much a guide for others as it is a personal milestone in my cybersecurity journey.


### About Boss of the SOC version 1
- **BOTSv1** is the **first-ever** Boss of the SOC (BOTS) event debuted at Splunk **.conf2016**. This initial challenge introduced participants to an engaging and immersive storyline centered around Wayne Corporation—one of the largest and most influential companies in the world, famously associated with Batman (In imagination, ofc xD).

- The scenario begins with a startling incident: the **defacement** of the Wayne Corporation website. As participants, we step into the role of Alice Bluebird' persona, **a security analyst** tasked with conducting a **root cause analysis**. Our mission is to **investigate** the incident, uncover the series of events that led to the attack, and answer a series of questions designed to guide us through the forensic investigation.

# Enviroment setup
- **Pre-requisites:** Participating in Boss of the SOC (BOTS) is easier than ever, thanks to its availability on various platforms:
  - [Splunk Officialy](https://bots.splunk.com/login?redirect=/)
  - [TryHackMe](https://tryhackme.com/)
  - [CyberDefenders](https://cyberdefenders.org/)
  
*However, all the walkthroughs in this guide are based on **self-hosted setup**, including more or less what's CTF scoreboard look like. If you'd like to follow along or set up your own environment, check out this [detailed post](http://localhost:4000/posts/BOTS-setup/) where we’ll walk through everything step-by-step together, thank you.*

- **Dataset Information:** For this walkthrough, I’m using the complete dataset from BOTSv1, which includes approximately 33 million event records. This dataset is notably challenging due to the mix of **legitimate activity**, **noisy data**, and **attack events**. While it adds complexity, it also provides an excellent opportunity to hone our search and analysis skills, making the experience both rewarding and comprehensive.

# Walkthrough 
### Let's Splunking !
Before deep diving into answer BOTS questions, i would like to prepare some SPL search to make my life easier since me and your are going to "Black box hunting", right ?
- First is `|metadata index="botsv1" type=sourcetypes | stats values(sourcetype)`, the following SPL command helps me quickly identify the sourcetypes present in the dataset. This gives me a clear idea of the types of data we should focus on during investigation:
- The second one is `|metasearch index="botsv1" sourcetype=<specific_sourcetype> <keyword>`, this command helps me pinpoint specific data sources based on your investigation's context and keywords. For example, if the challenge involves a web application security question, and have some sort of keywords like "injection" or "spoofing." While this could involve multiple sourcetypes such as HTTP logs, firewall logs, or IDS/IPS logs, this command helps narrow the scope. It provides a starting point for which sourcetypes are most likely to contain the relevant information.
- The third one is `|fieldsummary` with marcro setup. The full of my search is:
```sql
| fieldsummary 
| fields field values value 
| rex field=values max_match=0 "\"value\":\"(?<value>[^\"]+)\""
| fields field value
```
*You will see why those searches helped me so much in this walkthrough.*

#### Question 1 (101): What is the likely IP address of someone from the Po1s0n1vy group scanning imreallynotbatman.com for web application vulnerabilities?

![pic1](assets/images/botsv1/pic1.png){: w="250" h="50" }{: .right }
Firstly, let take a look into our sourcetypes by using `|metadata index="botsv1" type=sourcetypes | stats values(sourcetype)` to see if there are any relevant types of data we could starting with. Because the question is about an external IP Address from Po1s0n1vy scanning a website. We could start with these sourcetypes:
 - fortigate_*
 - stream:http
 - suricata 
<br>
<br>
<br>
<br>

Let's start with `fortigate_*` sourcetypes, i will this SPL search with keyword is "imreallynotbatman.com":
```sql
index="botsv1" sourcetype=fortigate_* imreallynotbatman.com 
| fieldsummary 
| fields field values value 
| rex field=values max_match=0 "\"value\":\"(?<value>[^\"]+)\""
| fields field value
```
![pic2](/assets/images/botsv1/pic2.png){: w="270" h="100" }{: .right }
Seems like we found something here, dive diving into that by using this SPL search:

`index="botsv1" sourcetype=fortigate_* imreallynotbatman.com attack="Acunetix.Web.Vulnerability.Scanner"
|table srcip dstip
|stats count by srcip dstip`

You could see the IP Address of the external IP was trying to scan the Web Server:
```shell
srcip           dstip             count
40.80.148.42    192.168.250.40    1
40.80.148.42    192.168.250.70    4144
```
**ANSWER: 40.80.148.42**
<br>
<br>

#### Question 2 (102): What company created the web vulnerability scanner used by Po1s0n1vy? Type the company name. (For example "Microsoft" or "Oracle")
Based on previous question and googling, we already know that the advesary is using [Acunetix](https://www.acunetix.com/) by Invicti - A Web Application and API Security Scanner.

**ANSWER: Acunetix**

#### Question 3 (103): What content management system is imreallynotbatman.com likely using?(Please do not include punctuation such as . , ! ? in your answer. We are looking for alpha characters only.)

First thing, what's CMS ? Content management system is a web application or software that manages digital content, allowing multiple contributors to create, edit and publish from a single dashboard. Content in a CMS is typically stored in a database and displayed in a presentation layer based on a set of templates like a website.

Some of the best and most popular CMS providers that we might see in Internet are:
- Wordpress (this one has a lot of security issues tbh)
- Hubspot
- Joomla
- Magento
...etc

So, which one is using by Wayne Corp ? We already knew that 192.168.250.70 is internal IP Address of the Web Server, so let's use that clue to investigate.

