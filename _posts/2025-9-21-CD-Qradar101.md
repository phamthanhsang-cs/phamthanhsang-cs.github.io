---
title: Threat Hunting - Qradar101 @CyberDefender
date: 2025-9-21 00:00:00 +0700
categories: [dfir, blue-teaming, cyber-defender]
tags: [threat-hunting, siem]
author: <author_id>
description: Qradar101 Lab @CyberDefender Walkthrough
# toc: false # Uncomment to disable the Table of Contents in the right panel
# comments: false # Uncomment to disable comments
image: /assets/images/preview/ccdlogo.png
--- 

### Scenario 
A financial company was compromised, and they are looking for a security analyst to help them investigate the incident. The company suspects that an insider helped the attacker get into the network, but they have no evidence.
 
The initial analysis performed by the company's team showed that many systems were compromised. Also, alerts indicate the use of well known malicious tools in the network. As a SOC analyst, you are assigned to investigate the incident using QRadar SIEM and reconstruct the events carried out by the attacker.

### Data Collected 
#### Dataset
- Sysmon - swift on security configuration
- Powershell logging
- Windows Eventlog
- Suricata IDS
- Zeek logs (conn, HTTP)

#### Instructions
- Compatibility: **VirtualBox**
- Uncompress the lab (pass: cyberdefenders.org)
- Zip SHA1: `7d2e0b18bc11e9987431369b180577886d956b0a`
- Zip size: 20 GB
- Please make sure to watch the instructional video under the Walkthroughs section.
- Make sure you have a host-only subnet within the following IP range **192.168.20.0/24**.
- Assign the proper network adapter (192.168.20.0/24) to the VM before starting it.
- Wait for some minutes after the import completes then visit: `https://192.168.20.21/`.
- Challenge credentials: **QRadar Dashboard**: `admin`:`Admin@123` - **SSH**: `root`:`cyberdefenders`

In case you face a license issue, please go to > License Pool Management. Edit and set eps > 0 and edit the FPM and set it to 0. This will ensure you will not have a license problem.

#### Hardware Requirements 
- **8GB** of memory 
- **65GB** of disk space

### Tools
- [IBM QRadar SIEM](https://www.ibm.com/products/qradar-siem)

### Enviroment Setup (Optional)

> Purpose of this section is guide you through the setup process step-by-step, you could skip this section go straigth to **Questions**, but it doesn't hurt to read this one if you don't know how to set things up. 
{: .prompt-tip }

#### Install VirtualBox and Data set
First thing is to install required components included VirtualBox and Cyber Defender Lab data set. 

VirtualBox is free and could setup easily by click "Next" to "dead end" to download our go-to Hypervisor visist their [Download page](https://www.virtualbox.org/wiki/Downloads)

![pic1](assets/images/cyberdefender/qradar101/pic1.png)

Depend on your host OS (Windows, Linux or MacOS), you might want to install correctsponding package, also install their **VirtualBox Extension Pack** - an extended features package (In case you want to remote control to the guest **without** network connectivity)

After install Virtualbox successfully, you should able to access its GUI like below.

![pic2](assets/images/cyberdefender/qradar101/pic2.png)

Also, add your **VirtualBox Extension Pack** by navigate to **Extension** tab and import your downloaded packages

![pic3](assets/images/cyberdefender/qradar101/pic3.png)

Next, go to [CyberDefender Qradar101 Lab](https://cyberdefenders.org/blueteam-ctf-challenges/qradar101/) and install Data set, make sure you have enough space for it (Atleast 90GB, 20GB for compressed file and > 60GB after decompress)

![pic4](assets/images/cyberdefender/qradar101/pic4.png)

After that, you might now want to decompress the archive by using any file archiving software of your choice such as 7z, Winrar, or Linux utilities like `unzip` and **DO NOT** forget unarchive password which is `cyberdefenders.org`.

![pic9](assets/images/cyberdefender/qradar101/pic9.png)
_The `CD.Qradar.ova` is our virtual machine file that need to import into VirtualBox_

#### Network Setup on VirtualBox

Follow CyberDefender Instructions, we must create a **host-only** network with IP range **192.168.20.0/24**, do it by navigate to **Network** tab, in **Host-only Networks** section, choose **Create**, VirtualBox will automatically create new network with random subnet within **192.168.0.0/16** subnet.

![pic5](assets/images/cyberdefender/qradar101/pic5.png)

New Host-Only Adapter created sucessfully.

![pic6](assets/images/cyberdefender/qradar101/pic6.png)

Now, config your Adapter properties below to correct subnet following CyberDefender Instructions.

![pic7](assets/images/cyberdefender/qradar101/pic7.png)

> NOTE: You don't have to setup DHCP server, since provided virtual machine by CyberDefenders comes with pre-config network which is `192.168.20.21`.
{: .prompt-tip }

#### Import Data Set
Depent on your host, you might would like to setup VirtualBox storage path, the purpose of this action is for easy managable virtual machine storages.

On my host, i had a separated folder for VirtualBox and inside will be multiple folders for each virtual machine.

![pic8](assets/images/cyberdefender/qradar101/pic8.png)

```shell
D:\
└── vm-storages
    └── virtualbox
        └── ccd-qradar101
        └── machine2
        └── machine3
        └── ...
    └── vmware-workstation <---- to give you an idea of how i structure my virtual storages
        └── machine1
        └── machine2
        └── machine3
        └── ...
```

After setup your folder path nicely, now import CyberDefenders Qradar Lab by navigate open VirtualBox, navigate to **File** and click on **Import Appliance** or simply press **Ctrl + I**

![pic10](assets/images/cyberdefender/qradar101/pic10.png)

On **Source** section, choose Local File System, click on folder icon and find your lab `CD.Qradar.ova` file.

Important part is **Settings** section since you will have to setup correct **Machine Base Folder**, by default VirtualBox set the path to `C:\Users\PC\VirtualBox VMs`, in case you already have a desired path rather than default, change it by click on arrow down icon and choose **Others**

> NOTE: YOU MUST CHANGE MAC ADDRESS POLICY TO **"INCLUDE ALL NETWORK ADAPTER MAC ADDRESS"** OR THE LAB VIRTUAL MACHINE WON'T RECEIVE IP ADDRESS.
{: .prompt-warning }

![pic11](assets/images/cyberdefender/qradar101/pic11.png)

Double check your settings and Click **Finish**, VirtualBox will do rest of the job itself to finish our lab machine.

Since the lab itself is kinda resources intensive, you might would've wait for a while to finish your importing process.

![pic12](assets/images/cyberdefender/qradar101/pic12.png)

#### Testing

Before spin up the lab, check the lab network adapter to confirm it attached to correct adapter by navigate to **Machine** section, click on lab machine and choose Settings tab.

![pic13](assets/images/cyberdefender/qradar101/pic13.png)

In **Settings** tab, navigate to Network and check your Network section:

![pic14](assets/images/cyberdefender/qradar101/pic14.png)

Also, depents on your machine resources, change some hardware resources such as number of vCPUs or RAM to improve lab performance. 

Since my host has 32GB of RAM, i will change my lab RAM resource to 16GB and i also change my number of vCPUs to 6 (In **General**). 

![pic15](assets/images/cyberdefender/qradar101/pic15.png)

![pic16](assets/images/cyberdefender/qradar101/pic16.png)

Now start your machine, either by double clicking on it or choose **Start**, login into your lab using `root`:`cyberdenfers`

![pic17](assets/images/cyberdefender/qradar101/pic17.png)

Using your Web Browser and go to https://192.168.20.21, if you follow above steps properly, you should see something similar like below

![pic18](assets/images/cyberdefender/qradar101/pic18.png)

Login IBM QRadar by using provided credential which is `admin`:`Admin@123`, compare to IBM QRadar SIEM lastest version, this look extremly older from GUI perspective ^^

![pic19](assets/images/cyberdefender/qradar101/pic19.png)
_HAPPY HUNTING !_

### Questions

#### Q1: How many log sources available?

#### Q2: What is the IDS software used to monitor the network?

#### Q3: What is the domain name used in the network?

#### Q4: Multiple IPs were communicating with the malicious server. One of them ends with "20". Provide the full IP.

#### Q5: What is the SID of the most frequent alert rule in the dataset?

#### Q6: What is the attacker's IP address?

#### Q7: The attacker was searching for data belonging to one of the company's projects, can you find the name of the project?

#### Q8: What is the IP address of the first infected machine?

#### Q9: What is the username of the infected employee using 192.168.10.15?

#### Q10: Hackers do not like logging, what logging was the attacker checking to see if enabled?

#### Q11: Name of the second system the attacker targeted to cover up the employee?

#### Q12: When was the first malicious connection to the domain controller (log start time - hh:mm:ss)?

#### Q13: What is the md5 hash of the malicious file?

#### Q14: What is the MITRE persistence technique ID used by the attacker?

#### Q15: What protocol is used to perform host discovery?

#### Q16: What is the email service used by the company?(one word)

#### Q17: What is the name of the malicious file used for the initial infection?

#### Q18: What is the name of the new account added by the attacker?

#### Q19: What is the PID of the process that performed injection?

#### Q20: What is the name of the tool used for lateral movement?

#### Q21: Attacker exfiltrated one file, what is the name of the tool used for exfiltration?

#### Q22: Who is the other legitimate domain admin other than the administrator?

#### Q23: The attacker used the host discovery technique to know how many hosts available in a certain network, what is the network the hacker scanned from the host IP 1 to 30?

#### Q24: What is the name of the employee who hired the attacker?

