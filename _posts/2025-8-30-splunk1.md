---
title: My Splunk Enviroment - Part 1
date: 2025-08-30 00:00:00 +0700
categories: [siem, blue-teaming, soc, cyber-defender]
tags: [splunk, network-security, log-analysis]  
author: <author_id>
description: Setting up my enterprise network enviroment for Splunking !
# toc: false # Uncomment to disable the Table of Contents in the right panel
# comments: false # Uncomment to disable comments
image: assets/images/preview/Splunk-Lab-DC-Site.png
--- 

Hi Splunkers! Because i'm involved in a project that leverages Splunk as a SIEM solution, I think this is a good time to design and build my own Splunk environment in my home lab.

We all know good / bad stuff about Splunk so I won't talk about it anymore. This blog series might solely focuses on the engineering side, so if you want to know more about analysis stuff and threat hunting, i highly recommend reading my Boss of the SOC series write-ups or those from others, which focus more on log analysis.

Before going straight into my Home Lab, let's see a bit of the "future" by knowing what we will learn and gain from this project:
- Be able to set up an "entire" Splunk distributed environment and how to connect components together (indexers, cluster manager, search head, etc).
- Be able to set up an "entire" Enterprise Network: a few firewalls, Windows environment, web application, etc. (This will be a very, very long project but really exciting)
- Know how to parse, ingest, and handle data in Splunk.
- Build data models in Splunk to normalize data from various sources.
- "Config as Code" by managing the Splunk environment with Git and KRSCONF.
- Detection Engineering stuff (this might be at the very end of the project once we collect enough data from data sources).

And yeah, that's it. Maybe at the end of the project, we could do some threat emulation and then hunt it in Splunk!!!

Since in Enterprise Network, we'll facing multiple data sources, also, come from widely known vendors, so my new home lab project is trying to replicate it as much as possible. 

![pic1](assets/images/splunk/pic2.png)

Let's take a look the overall project diagram, i separate into two main sites: 
- **Client Site** - which is Enterprise Network, i'm trying to think about what can i build inside it, so far:
  - Dual Firewalls setup, one from [Check Point](https://www.checkpoint.com/) and the another on comes from [Sophos](https://www.sophos.com/en-us).
  - Basic Windows envrioment with a Domain Controller and few workstations.
  - Also, a full web application where front-end, web server will place in DMZ while it's database will stay inside private, secured network.
- **External Site** - which is Splunk enviroment with multi Splunk Enterprise instances running different role:
  - 2 Indexers in my Indexing Tier for clustering. 
  - 1 Cluster Manager to manage those Indexers.
  - 1 Search Head for search interface.
  - 1 Deployment Server to manage configuration on forwarders and also search head 
  - 1 Heavy Forwader to receive **Client Site** data
    - *Beside those components, you might notice about one more Heavy Forwader appears in Client Site and also one [Splunk Connect for Syslog (SC4S)](https://splunk.github.io/splunk-connect-for-syslog/main/) instance, all are inside Collection Tier which is collect data from Client Site and forward to Splunk enviroment*

> One thing noteworthy, this project is not fixed, i might add / remove / change component inside my enviroment, for an instance, in case my Check Point license expire, i might change to other vendors, or more data sources (maybe from cloud vendors) that i need to onboard into my Splunk for practice , hence i'll update my diagram to keep up with those changes in the future.
{: .prompt-warning }


Let's take a look inside **Client Site** diagram below

![pic3](assets/images/splunk/Splunk-Lab-Client Site.svg)

The Enterprise Network has 2 main zones:
- Trusted Zone contains:
  - MGMT Network that use for management traffic only (you can say syslog for example, ssh, or network device control traffics, etc)
  - Local Network that use mostly for user data, logic segmented by virtual network and also firewall policies
- Untrusted Zone - This network uses for public services such as Company Web Application, File Transfer or Mail Servers, etc 

You could see that there are two firewalls from different vendors on my diagram, not only for apply defense in depth methodology:

*"If the adversary compromised servers from DMZ and pivot to the Perimeter Firewall (via firewall vulnerabilities), they couldn't easily get into private network since there's still another one, that don't have that vulnerability."*

But i want to get multiple sourcetypes from different firewalls to feed into my Splunk so i could practice on a diverse set of logs 

Now let's move on to **External Site** diagram, as it shows below

![pic4](assets/images/splunk/Splunk-Lab-Splunk Zone.svg)

All data that has been collected will come to the Client Heavy Forwarder first (data collected by UFs, SC4S, HEC, etc), and then be forwarded to the Accessible Heavy Forwarder from the Splunk Zone. The reason behind this architecture is: imagine you implement an environment that collects data from multiple clients; each time you add more indexers into your cluster, client network admins have to add new IP addresses of the new indexers, which is kinda frustrating if you have hundreds or thousands of clients.

The rest is just follow [Splunk Validated Architectures - SVAs](https://www.splunk.com/en_us/pdfs/white-paper/splunk-validated-architectures.pdf)

Well, i think that's enough for Part 1, thanks for reading. In Part 2, i'll talk about my Proxmox enviroment, define Network Zones on Proxmox SDN, implement VNets Firewall properbly for our Lab.

